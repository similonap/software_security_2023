<!DOCTYPE html>
<html>
<head>
<title>instructies.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<!-- 
DISCLAIMER:

!!!!

GEBRUIK NIET DIT BESTAND OM HET LABO TE MAKEN MAAR GEBRUIK DE LINK OP DIGITAP!

!!!!
-->
<style>
.holder_default {
    width:500px; 
    height:150px; 
    border: 3px dashed #ccc;
}

.hover { 
    width:400px; 
    height:150px; 
    border: 3px dashed #0c0 !important; 
}

.hidden {
    visibility: hidden;
}

.visible {
    visibility: visible;
}
</style>
<script type="application/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.0.2/jquery.min.js"></script>
<div id="alles">
<h1 id="httpsssl">HTTPS/SSL</h1>
<h2 id="httphttps">HTTP/HTTPS</h2>
<h3 id="wat-ga-je-leren-in-dit-labo">Wat ga je leren in dit labo?</h3>
<ul>
<li>Een self signed certificate aanmaken met openssl.</li>
<li>Testen met Open SSL</li>
</ul>
<h3 id="stappenplan">Stappenplan</h3>
<ol>
<li>
<p>We raden je aan om google chrome te gebruiken voor dit labo. Wens je dat niet te doen zal je voor sommige settings zelf op zoek moeten gaan.</p>
</li>
<li>
<p>Doe een git clone van de volgende repository (of git pull indien je deze repo al hebt)</p>
<p><code>https://github.com/similonap/software_security_2021.git</code></p>
</li>
<li>
<p>Open de terminal in <code>labo_https_ssl</code> via visual studio code en installeer alle npm dependencies met</p>
<pre class="hljs"><code><div>npm install
</div></code></pre>
</li>
<li>
<p>We hebben voor deze oefening een webserver in node js geschreven. Je kan deze opstarten met</p>
<pre class="hljs"><code><div>node http.js
</div></code></pre>
<p>Merk op dat er een opmerking staat die vermeld:</p>
<pre class="hljs"><code><div>You have not generated a certificate yet. 
</div></code></pre>
<p>Dit lossen we zodra op.</p>
</li>
<li>
<p>Open je browser (liefst chrome) op de adressen die in de terminal zijn gegeven.</p>
<p>Op http://localhost:3000 zal je een website te zien krijgen die twee links bevat: &quot;Form with GET&quot; en &quot;Form with POST&quot;.</p>
<p>Op https://localhost:3001 krijg je een foutboodschap te zien:</p>
 <img src="http_error_1.png" width="400">
<p>Dit komt omdat we nog geen certificaat hebben aangemaakt voor onze webserver.</p>
</li>
<li>
<p>Sluit de webserver terug af door CTRL-C te drukken in je terminal venster.</p>
</li>
<li>
<p>Om de webserver correct te laten opstarten moeten we met openssl een self signed certificaat maken. Normaal gezien worden certificaten afgeleverd door een certificate authority. Dit is is een organisatie die digitale certificaten aan personen of bedrijven verleent na hun identiteit gecontroleerd te hebben. Dit kost meestal geld dus we gaan natuurlijk in deze cursus dit niet doen. Wij gaan gewoon zelf ons eigen certificaat signen en daar mee werken.</p>
</li>
<li>
<p>Voer in dezelfde directory als hiervoor het volgende commando uit:</p>
<pre class="hljs"><code><div>openssl genrsa -out key.pem 4096

openssl req -new -sha256 -out private.csr -key key.pem -config ssl.conf 

openssl x509 -req -days 3650 -in private.csr -signkey key.pem -out cert.pem -extensions req_ext -extfile ssl.conf
</div></code></pre>
<p>Je krijgt hier een aantal vragen met informatie die in het certificaat zullen opgeslagen worden ter identificatie:</p>
<pre class="hljs"><code><div>Country Name (2 letter code) []:BE
State or Province Name (full name) []:Antwerpen
Locality Name (eg, city) []:Antwerpen
Organization Name (eg, company) []:AP
Organizational Unit Name (eg, section) []:Software Security
Common Name (eg, fully qualified host name) []:localhost
</div></code></pre>
<p>Dit zal twee bestanden aanmaken key.pem en cert.pem. Het eerste bestand is je private sleutel waarmee je je certificaat mee gesigned hebt. En het tweede bestand is het certificaat zelf.</p>
<p><strong>Merk op:</strong> Als je het bestand key.pem opendoet merk je op dat dit heel hard trekt op de private sleutel uit het vorige labo over encryptie.</p>
</li>
<li>
<p>Je kan de inhoud van een certificaat op de volgende manier in textvorm bekijken:</p>
<pre class="hljs"><code><div>openssl x509 -in cert.pem -text
</div></code></pre>
<p>Neem een screenshot zodat de <code>Subject</code> uit de output duidelijk zichtbaar is en sleep deze hieronder in:</p>
 <div id="holder2" style="" class="holder_default">
       <img src="" id="holder2_image_droped"  style="max-width:80%; border: 3px dashed #7A97FC;" class=" hidden"/>
 </div>
 <script>
     $(document).ready(function() {
         addDrop('holder2')
     });
 </script>
</li>
<li>
<p>Als je nu de webserver terug opstart met <code>node http.js</code> dan zal je niet meer dezelfde fout krijgen bij het opstarten.</p>
</li>
<li>
<p>Als je nu naar https://localhost:3001 gaat dan krijg je de volgende boodschap te zien:</p>
 <img src="http_warning_1.png" width="400">
<p>Klik op Advanced (Geavanceerd) en dan krijg klapt het open en dan klik je op &quot;Proceed to localhost(unsafe)&quot;</p>
 <img src="http_warning_2.png" width="400">
<p>dan krijg je gewoon de website te zien zoals bij de http versie.</p>
<p><strong>Opgelet</strong>: als je niet de optie krijgt om verder te gaan. Typ dan <code>chrome://flags/#allow-insecure-localhost</code> in je browser en zet deze op Enabled.</p>
</li>
<li>
<p>Waarom waarschuwt je browser je hier over? Waarom is dit onveilig?</p>
 <textarea style="width: 100%;" rows="5">
 </textarea>
</li>
<li>
<p>Laat zien dat deze verbinding niet secure is aan de hand van de adresbalk.</p>
<p>Neem hier een screenshot van en sleep deze hieronder in:</p>
 <div id="holder1" style="" class="holder_default">
       <img src="" id="holder1_image_droped"  style="max-width:80%; border: 3px dashed #7A97FC;" class=" hidden"/>
 </div>
 <script>
     $(document).ready(function() {
         addDrop('holder1')
     });
 </script>    
</li>
<li>
<p>Bepaal de SSL/TLS capabilities van jouw browser aan de hand van de website</p>
<p><a href="https://clienttest.ssllabs.com/">https://clienttest.ssllabs.com/</a></p>
<p>Voor welke versie(s) van SSL/TLS heeft jouw browser support?</p>
<textarea style="width: 100%;" rows="3">
</textarea>
<p>Waarom zijn lagere versies niet meer supported?</p>
<textarea style="width: 100%;" rows="5">
</textarea>
</li>
<li>
<p>Open een tweede terminal venster terwijl je webserver nog opstaat. En run het volgende commando:</p>
<pre class="hljs"><code><div>openssl s_client -connect localhost:3001
</div></code></pre>
</li>
<li>
<p>Welk TLS protocol ondersteunt onze eigen gemaakte server? (Zie naar de output van vorig commando)</p>
<textarea style="width: 100%;" rows="2">
</textarea>
</li>
<li>
<p>Verlaag nu de versie van TLS van onze web server naar TLS 1.0.</p>
<p>Dit kan gedaan worden door de lijn:</p>
<pre class="hljs"><code><div>secureProtocol  : 'TLS_method',
</div></code></pre>
<p>te vervangen met:</p>
<pre class="hljs"><code><div>secureProtocol  : 'TLSv1_method',
</div></code></pre>
<p>te veranderen in <code>http.js</code>. Start daarna de web server terug op.</p>
</li>
<li>
<p>Ga naar terug naar de https website en open de chrome developer tools (CTRL-SHIFT-J) en ga vervolgens naar de security tab. Hier kan je allerlei informatie over de security zien van deze pagina.</p>
<p>Ondersteunt jouw browser deze versie van TLS?</p>
<textarea style="width: 100%;" rows="2">
</textarea>
<p>Vanaf welke versie dan wel?</p>
<textarea style="width: 100%;" rows="2">
</textarea>
</li>
<li>
<p>Je kan nu testen of de server specifiek een versie van TLS ondersteunt met het volgende commando:</p>
<pre class="hljs"><code><div>openssl s_client -connect localhost:3001 -tls1_3
</div></code></pre>
<p>Neem een screenshot waar de output duidelijk te zien is en sleep deze hieronder in:</p>
<div id="holder4" style="" class="holder_default">
      <img src="" id="holder4_image_droped"  style="max-width:80%; border: 3px dashed #7A97FC;" class=" hidden"/>
</div>
<script>
    $(document).ready(function() {
        addDrop('holder4')
    });
</script>
</li>
<li>
<p>Zet nu de versie van TLS op 1.2 in de <strong>http.js</strong> file (TLSv1_2_method) en ciphers op TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 (of deze key helemaal verwijderen).</p>
</li>
<li>
<p>Zorg ervoor dat het het certificaat in je trusted root certfication authorities van je operating system komt te staan.</p>
<p>Windows:</p>
<ul>
<li>Open de Microsoft Management Console (Windows key-R en dan mmc intypen)</li>
<li>Add remove snap-in</li>
<li>Voeg de certificate snap-in toe</li>
<li>Kies computer account (Next)</li>
<li>Klik op finish</li>
<li>Ga naar Trusted Root Certification Authorities/Certificates</li>
<li>Klik op Actions -&gt; All Tasks -&gt; Import</li>
<li>Importeer jouw cert.pem (altijd next klikken)</li>
</ul>
<p>Mac Os:</p>
<ul>
<li>Dubbelklik op het <code>cert.pem</code> bestand</li>
<li>Kies keychain 'system'</li>
<li>Dubbelklik op 'localhost' die net is toegevoegd</li>
<li>Kijk zeker na of het jouw certificaat is!</li>
<li>Klik op trust en kies Always Trust bij SSL</li>
</ul>
<p>Sluit chrome volledig (Chrome menu--&gt;Exit, niet enkel kruisje) en ga terug naar</p>
<pre class="hljs"><code><div>https://localhost:3001
</div></code></pre>
<p>en neem een screenshot van je browser die aantoont dat er een slotje staat in de adresbalk:</p>
<div id="holder3" style="" class="holder_default">
      <img src="" id="holder3_image_droped"  style="max-width:80%; border: 3px dashed #7A97FC;" class=" hidden"/>
</div>
<script>
    $(document).ready(function() {
        addDrop('holder3')
    });
</script>
</li>
<li>
<p>Print deze pagina af als PDF en slaag deze op als <code>naam_voornaam_labo_https_ssl.pdf</code></p>
<p>Zip alle bestanden die je in dit labo hebt aangemaakt en stuur deze in via digitap. Deze bestanden zijn:</p>
<ul>
<li>naam_voornaam_labo_https_ssl.pdf</li>
<li>http.js</li>
</ul>
</li>
</ol>
<script>
function addDrop(id) {
    var holder = document.getElementById(id);
    holder.ondragover = function () { this.className = 'hover'; return false; };
    holder.ondrop = function (e) {
      this.className = 'hidden';
      e.preventDefault();
      var file = e.dataTransfer.files[0];
      var reader = new FileReader();
      reader.onload = function (event) {
          document.getElementById(id + '_image_droped').className='visible'
          $('#' + id + '_image_droped').attr('src', event.target.result);
      }
      reader.readAsDataURL(file);
    };
}
</script>
</body>
</html>
